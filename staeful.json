{
    "states": {
        "init": {
            "transitions": [
                {
                    "transiotion_condition": "p[flag] = 'SYN'",
                    "transition_response": "multi line scapy code\nfgsfgdsfg",
                    "next_state": "3WHS_SYN"
                },
                {
                    "transiotion_condition": "p[flag] = 'FIN'",
                    "next_state": "FIN"
                }
            ] 

        },
        "3WHS_SYN": {
            "transitions": [
                {
                    "transiotion_condition": "p[flag] = 'ACK'",
                    "transition_response": "multi line scapy code",
                    "next_state": "3WHS_COMPLETE"
                },
                {
                    "transiotion_condition": "p[flag] = 'FIN'",
                    "next_state": "FIN"
                }
            ]
        },
        "3WHS_COMPLETE": {
            "transitions": [
                {
                    "transiotion_condition": "p[flag] = 'ACK'",
                    "transition_response": "multi line scapy code",
                    "next_state": "3WHS_COMPLETE"
                },
                {
                    "transiotion_condition": "p[flag] = 'FIN'",
                    "next_state": "FIN"
                }
            ]
        },
        "FIN": {
            "pre_state": "scapy code to colse connection and kill thread",
            "transitions": [
                {
                    "transiotion_condition": "p[flag] = 'ACK'",
                    "transition_response": "multi line scapy code",
                    "next_state": "3WHS_COMPLETE"
                }
            ]
        }
    }
}